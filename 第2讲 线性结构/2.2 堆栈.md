## 什么是堆栈
堆栈是一种线性结构, 也是一种特殊的线性表, 在函数调用、递归、表达式求值经常用到。

- 计算机如何进行表达式求值?

![](http://qiniu.rearib.top/20191911/1352-w.png)

### 表达式
- 中缀表达式:运算符号位于两个运算数之间.如a+b*c-d/e
- 后缀表达式:运算符号位于两个运算数之后.如abc*+de/-
- 前缀表达式:运算符号位于两个运算数之前.如-+a*bc/de

例如:62/3-42*+=?
>6/2-3+4*2=8

后缀表达式求值策略:从左向右"扫描",逐个处理运算数和运算符号
1. 遇到运算数怎么办?如何"记住"目前还不未参与运算的数?
2. 遇到运算符号怎么办?对应的运算数是什么?

- 启示:需要有种存储方法,能顺序存储运算数,并在需要时"倒序"输出!

### 堆栈的抽象数据类型描述
- 堆栈(Stack):具有一定操作约束的线性表
- 只在一端(栈顶,Top)做插入、删除
- 插入数据:入栈(Push)
- 删除数据:出栈(Pop)
- 后入先出: Last In first Out(LIFO)

![](http://qiniu.rearib.top/20191911/1407-G.png)

### 栈的顺序存储实现
栈的顺序存储结构通常由一个一维数组和一个记录栈顶元素位置的变量组成.

![](http://qiniu.rearib.top/20191911/1410-f.png)

![](http://qiniu.rearib.top/20191911/1411-h.png)

#### 问题讨论
> 请用一个数组实现两个堆栈,要求最大地利用数组空间,使数组只要有空间入栈操作就可以成功

[分析]一种比较聪明的方法是使这两个栈分别从数组的两头开始向中间生长;当两个栈的栈顶指针相遇时,表示两个栈都满了.

![](http://qiniu.rearib.top/20191911/1414-0.png)

![](http://qiniu.rearib.top/20191911/1415-Q.png)

> 堆栈顺序存储的另一种实现？

```
#define MaxSize 100
ElementType S[MaxSize];
int top;
void Push(ElementType *S, int top, ElementType item)
{   if (top==MaxSize-1) {
          printf(“堆栈满”);  return;
    }else {
          S[++top] = item;
         return;
    }
}
```
该方法是不正确的, 在函数内部操作的top是局部变量, 函数执行完后不会将修改后的top返回, 所以需要传入top的地址或者将top值作为函数值返回

### 堆栈的链式存储实现
栈的链式存储结构实际上就是一个单链表,叫做链栈.插入和删除操作只能在链栈的栈顶进行.栈顶指针Top应该在链表的头, 不能在链表的尾部.

![](http://qiniu.rearib.top/20191911/1429-D.png)

![](http://qiniu.rearib.top/20191911/1450-G.png)

![](http://qiniu.rearib.top/20191911/1456-X.png)

头节点: 头节点不存储数据, 只存下一个节点的地址

### 堆栈应用:表达式求值
- 回忆:应用堆栈实现后缀表达式求值的基本过程:从左到右读入后缀表达式的各项(运算符或运算数)

1. 运算数:入栈
2. 运算符:从堆栈中弹出适当数量的运算数,计算并结果入栈
3. 最后,堆栈顶上的元素就是表达式的结果值.

#### 中缀表达式求值
基本策略:将中缀表达式转换为后缀表达式,然后求值
- 如何将中缀表达式转换为后缀?

![](http://qiniu.rearib.top/20191911/1503-N.png)


### 中缀表达式如何转换为后缀表达式
- 从头到尾读取**中缀表达式的每个对象**,对不同对象按不同的情况处理.
1. 运算数:直接输出
2. 左括号:压入堆栈;
3. 右括号:将栈顶的运算符弹出并输出,直到遇到左括号(出栈,不输出)
4. 运算符:
   - 若优先级大于栈顶运算符时,则把它压栈
   - 若优先级小于等于栈顶运算符时,将栈顶运算符弹出并输出;再比较新的栈顶运算符,直到该运算符大于栈顶运算符优先级为止,然后将该运算符压栈
5. 若各对象处理完毕,则把堆栈中存留的运算符一并输出.

![](http://qiniu.rearib.top/20191911/1512-O.png)

#### 题目
- 堆栈将中缀表达式2*(6/3+4)-5转换为后缀表达式。在这个转换过程中，堆栈元素最多时元素个数是3个.

- 若用单向链表实现一个堆栈，当前链表状态为：1->2->3。当对该堆栈执行pop()、push(4)操作后，链表状态变成4->2->3 

### 堆栈的其他应用:
- 函数调用及递归实现
- 深度优先搜索
- 回溯算法